@using System.Text.Json

@model Frontend.ViewModels.ProductDisplayViewModel

<div class="max-w-[1200px] mx-auto px-4 py-8">
    <!-- Breadcrumb -->
    <nav class="flex items-center space-x-2 text-sm text-gray-600 mb-6">
        <a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Index">Home</a>
        <span>/</span>
        <a class="nav-link text-dark" asp-area="" asp-controller="Product" asp-action="Index">Product</a>
        <span>/</span>
        <span class="text-gray-800 font-medium">@Model.Category</span>
    </nav>

    <!-- Main Product Section -->
    <div class="overflow-hidden">
        <div class="w-full grid grid-cols-1 lg:grid-cols-2 gap-10 py-8">
            <!-- Image Slider Section -->
            <div class="space-y-4">
                <!-- Main Image Display -->
                <div class="relative bg-gray-100 rounded-xl overflow-hidden aspect-3/2">
                    <img id="mainImage" src="http://localhost:5271/@Model.ProductImages?.FirstOrDefault()?.FilePath"
                        alt="Product Image" class="w-full h-full object-cover">
                    <!-- Navigation Arrows -->
                    <button onclick="previousImage()"
                        class="absolute left-4 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white p-3 rounded-full shadow-lg transition">
                        <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7">
                            </path>
                        </svg>
                    </button>
                    <button onclick="nextImage()"
                        class="absolute right-4 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white p-3 rounded-full shadow-lg transition">
                        <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7">
                            </path>
                        </svg>
                    </button>
                    <!-- Image Counter -->
                    <div class="absolute bottom-4 right-4 bg-black/70 text-white px-3 py-1 rounded-full text-sm">
                        <span id="imageCounter">1 / @Model.ProductImages!.Count</span>
                    </div>
                </div>

                <div class="grid grid-cols-4 gap-3">
                    <!-- Thumbnail Images -->
                    @for (int i = 0; i < @Model?.ProductImages?.Count; i++)
                    {
                        <button onclick="selectImage(i)"
                            class="thumbnail-btn relative rounded-lg overflow-hidden border-2 border-blue-500 aspect-square">
                            <img src="@ViewBag.Images[i]" alt="Thumbnail 1" class="w-full h-full object-cover">
                        </button>
                    }
                </div>
            </div>

            <!-- Product Info Section -->
            <div class="flex flex-col">
                <!-- Category Badge -->
                <div class="mb-3">
                    <span class="inline-block bg-blue-100 text-blue-600 text-sm font-semibold px-3 py-1 rounded-full">
                        @Model?.Category
                    </span>
                </div>

                <!-- Product Name -->
                <h1 class="text-4xl font-bold text-gray-800 mb-2">@Model?.Name</h1>

                <!-- Rating -->
                <div class="flex items-center mb-6">
                    <div class="flex text-yellow-400">
                        <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20">
                            <path
                                d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z" />
                        </svg>
                        <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20">
                            <path
                                d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z" />
                        </svg>
                        <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20">
                            <path
                                d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z" />
                        </svg>
                        <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20">
                            <path
                                d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z" />
                        </svg>
                        <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20">
                            <path
                                d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z" />
                        </svg>
                    </div>
                    <span class="text-gray-600 ml-2 text-sm">(256 reviews)</span>
                </div>

                <!-- Price -->
                <div class="mb-4">
                    <span class="text-4xl font-bold text-gray-800">Rs. @Model?.Price</span>
                    <span class="text-lg text-gray-400 line-through ml-3">$12,000</span>
                    <span class="ml-3 bg-green-100 text-green-700 text-sm font-semibold px-2 py-1 rounded">16%
                        OFF</span>
                </div>

                <!-- Description -->
                <div class="mb-4">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Description</h3>
                    <p class="text-gray-600 leading-relaxed">@Model.Description</p>
                </div>

                <!-- Stock Info -->
                <div class="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <span class="text-green-700 font-medium">In Stock - @Model.Stock units available</span>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex items-center gap-3">
                    <button
                        class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 font-semibold text-lg transition shadow-lg flex items-center justify-center space-x-2"
                        style="border-radius: 10px">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z">
                            </path>
                        </svg>
                        <span>Add to Cart</span>
                    </button>
                    <button
                        class="w-full border-2 border-gray-300 hover:border-blue-500 text-gray-700 py-3 rounded-xl font-semibold text-lg transition flex items-center justify-center space-x-2"
                        style="border-radius: 10px">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">
                            </path>
                        </svg>
                        <span>Add to Wishlist</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const images =  @Html.Raw(JsonSerializer.Serialize(ViewBag.Images));
    let currentImageIndex = 0;
    let quantity = 1;

    function selectImage(index) {
        currentImageIndex = index;
        document.getElementById('mainImage').src = images[index];
        document.getElementById('imageCounter').textContent = `${index + 1} / ${images.length}`;

        // Update thumbnail borders
        const thumbnails = document.querySelectorAll('.thumbnail-btn');
        thumbnails.forEach((btn, i) => {
            if (i === index) {
                btn.classList.remove('border-gray-200');
                btn.classList.add('border-blue-500');
            } else {
                btn.classList.remove('border-blue-500');
                btn.classList.add('border-gray-200');
            }
        });
    }

    function nextImage() {
        currentImageIndex = (currentImageIndex + 1) % images.length;
        selectImage(currentImageIndex);
    }

    function previousImage() {
        currentImageIndex = (currentImageIndex - 1 + images.length) % images.length;
        selectImage(currentImageIndex);
    }
</script>